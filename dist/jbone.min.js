/*!
 * jBone - v0.0.1 - 2013-11-06
 * Copyright (c) 2013 Alexey Kupriyanenko;
 * Licensed MIT
 */
!function(a,b){function c(){return this instanceof c?d.apply(this,arguments[0]):new c(arguments)}function d(){return Array.isArray(arguments[0])?arguments[0].forEach(function(a){e.call(this,[a])},this):arguments[0]&&e.call(this,arguments),this}function e(a){"string"==typeof a[0]&&a[0].match(j)?f.apply(this,a):"string"==typeof a[0]&&a[0].match(k)&&a[0].match(k)[1]?g.apply(this,a):"string"==typeof a[0]?h.apply(this,a):"string"!=typeof a[0]&&i.call(this,a[0])}function f(){var a=arguments[0].match(j)[1],b=document.createElement(a);c(b).attr(arguments[1]),i.call(this,b)}function g(a){var b=document.createElement("div");b.innerHTML=a,[].forEach.call(b.childNodes,function(a){i.call(this,a)}.bind(this))}function h(a){var b=document.querySelectorAll(a);[].forEach.call(b,function(a){i.call(this,a)},this)}function i(a){var b=a.jid||void 0;a===window?b="window":a.jid||(b=++c._cache.jid,a.jid=b),c._cache.events[b]||(c._cache.events[b]={}),this.push(a)}b["true"]=a;var j=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/;c.prototype=[],c._cache={events:{},jid:0},c._data=function(a){return a=a instanceof c?a[0]:a,a===window?{jid:"window"}:{jid:a.jid}},b.jBone=b.$=c,c.prototype.on=function(){var a,b,d,e,f,g=arguments[0];return 2===arguments.length?a=arguments[1]:(b=arguments[1],a=arguments[2]),this.forEach(function(h){f=c._cache.events[c._data(h).jid],d=g.split(".")[1],g=g.split(".")[0],f[g]=f[g]?f[g]:[],e=function(d){b?~c(h).find(b).indexOf(d.target)&&a.call(h,d):a.call(h,d)},f[g].push({namespace:d,fn:e,originfn:a}),h.addEventListener&&h.addEventListener(g,e,!1)}),this},c.prototype.trigger=function(a,b){var d=document.createEvent("CustomEvent");return d.initCustomEvent(a,!0,!0,null),this.forEach(function(e){e.dispatchEvent?e.dispatchEvent(d):c._cache.events[jBase._data(e).jid][a]&&c._cache.events[jBase._data(e).jid][a].forEach(function(a){a.fn.call(e,b)})}),this},c.prototype.off=function(a,b){var d,e,f=function(a){return b&&a.originfn===b?a.fn:b?void 0:a.fn},g=a.split(".")[1];return a=a.split(".")[0],this.forEach(function(b){d=c._cache.events[c._data(b).jid],d[a]?d[a].forEach(function(c){e=f(c),g?c.namespace===g&&b.removeEventListener(a,e):g||b.removeEventListener(a,e)}):g&&Object.keys(d).forEach(function(a){d[a].forEach(function(c){e=f(c),c.namespace===g&&b.removeEventListener(a,e)})})}),this},c.prototype.is=function(){var a=arguments;return this.some(function(b){return b.tagName.toLowerCase()===a[0]})},c.prototype.has=function(){var a=arguments;return this.some(function(b){return b.querySelectorAll(a[0]).length})},c.prototype.attr=function(){var a=arguments;return"string"==typeof a[0]&&1===a.length?this[0].getAttribute(a[0]):("string"==typeof a[0]&&a.length>1?this.forEach(function(b){b.setAttribute(a[0],a[1])}):a[0]instanceof Object&&this.forEach(function(b){Object.keys(a[0]).forEach(function(c){b.setAttribute(c,a[0][c])})}),this)},c.prototype.find=function(a){var b=[];return this.forEach(function(c){[].forEach.call(c.querySelectorAll(a),function(a){b.push(a)})}),c(b)},c.prototype.get=function(a){return this[a]},c.prototype.eq=function(a){return c(this[a])},c.prototype.html=function(){var a,b=arguments[0];return void 0!==b?(this.forEach(function(d){"string"==typeof b?d.innerHTML=b:(a=document.createDocumentFragment(),b instanceof HTMLElement?a.appendChild(b):b instanceof c&&b.forEach(function(b){a.appendChild(b)}),c(d).empty(),d.appendChild(a))}),this):(a=[],this.forEach(function(b){b instanceof HTMLElement&&a.push(b.innerHTML)}),a.length?a.join(""):null)},c.prototype.append=function(a){return a instanceof c?this.forEach(function(b,c){a.forEach(function(a){c?b.appendChild(a.cloneNode()):b.appendChild(a)})}):a instanceof HTMLElement&&this.forEach(function(b){b.appendChild(a)}),this},c.prototype.empty=function(){return this.forEach(function(a){for(;a.hasChildNodes();)a.removeChild(a.lastChild)}),this}}({},function(){return this}());